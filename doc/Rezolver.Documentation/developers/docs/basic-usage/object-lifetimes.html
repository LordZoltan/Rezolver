<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
  	<meta charset="utf-8">
  	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  	<title>Object lifetimes in Rezolver </title>
  	<meta name="viewport" content="width=device-width">
  	<meta name="title" content="Object lifetimes in Rezolver ">
  	<meta name="generator" content="docfx 2.12.1.0">
  	
  	<link rel="shortcut icon" href="../../favicon.ico">
  	<link rel="stylesheet" href="../../styles/docfx.vendor.css">
  	<link rel="stylesheet" href="../../styles/docfx.css">
  	<link rel="stylesheet" href="../../styles/main.css">
  	<meta property="docfx:navrel" content="../../toc.html">
  	<meta property="docfx:tocrel" content="../toc.html">
  	<meta property="docfx:rel" content="../../">
  	
  		<link rel="apple-touch-icon" sizes="57x57" href="../../../apple-touch-icon-57x57.png">
  		<link rel="apple-touch-icon" sizes="60x60" href="../../../apple-touch-icon-60x60.png">
  		<link rel="apple-touch-icon" sizes="72x72" href="../../../apple-touch-icon-72x72.png">
  		<link rel="apple-touch-icon" sizes="76x76" href="../../../apple-touch-icon-76x76.png">
  		<link rel="apple-touch-icon" sizes="114x114" href="../../../apple-touch-icon-114x114.png">
  		<link rel="apple-touch-icon" sizes="120x120" href="../../../apple-touch-icon-120x120.png">
  		<link rel="apple-touch-icon" sizes="144x144" href="../../../apple-touch-icon-144x144.png">
  		<link rel="apple-touch-icon" sizes="152x152" href="../../../apple-touch-icon-152x152.png">
  		<link rel="apple-touch-icon" sizes="180x180" href="../../../apple-touch-icon-180x180.png">
  		<link rel="icon" type="image/png" href="../../../favicon-32x32.png" sizes="32x32">
  		<link rel="icon" type="image/png" href="../../../android-chrome-192x192.png" sizes="192x192">
  		<link rel="icon" type="image/png" href="../../../favicon-96x96.png" sizes="96x96">
  		<link rel="icon" type="image/png" href="../../../favicon-16x16.png" sizes="16x16">
  		<link rel="manifest" href="../../../manifest.json">
  		<link rel="mask-icon" href="../../../safari-pinned-tab.svg" color="#5bbad5">
  		<meta name="msapplication-TileColor" content="#da532c">
  		<meta name="msapplication-TileImage" content="../../../mstile-144x144.png">
  		<meta name="theme-color" content="#ffffff">
  </head>
  <body data-spy="scroll" data-target="#affix">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../../content/rz_square_white_on_orange_48x48.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items"></div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
              <h1 id="object-lifetimes-in-rezolver">Object lifetimes in Rezolver</h1>
              
<div class="TIP"><h5>Tip</h5><p>Read <a href="create-and-use-a-container.html">Creating and using a container</a> if you haven&#39;t already done so.</p>
</div>
<p>As with any IOC container, Rezolver understands the concept of object lifetimes, which are implemented
as different <a class="xref" href="../../api/Rezolver.ITarget.html">ITarget</a> implementations that can be registered in an <a class="xref" href="../../api/Rezolver.ITargetContainer.html">ITargetContainer</a>.</p>
<h2 id="what-is-a-lifetime">What is a lifetime?</h2>
<p>No, this is not a philosophical question ;)</p>
<p>In a crude sense, an object lifetime describes when a new object is created and whether a previously 
created object is subsequently returned from a container&#39;s <a class="xref" href="../../api/Rezolver.IContainer.html#Rezolver_IContainer_Resolve_">Resolve</a> method.</p>
<div class="NOTE"><h5>Note</h5><p>In practise, it&#39;s not that simple - because an IOC container&#39;s understanding of a lifetime does not
strictly map to whether a new instance is actually created at all.</p>
<p>It&#39;s more accurate to say that the lifetime determines <strong>when</strong> the
<strong><em>action</em></strong> that&#39;s been associated with a given service type is actually <strong><em>executed</em></strong>.</p>
</div>
<p>Rezolver understands three main lifetimes, which should be familiar to anyone who&#39;s used an IOC
container before:</p>
<h3 id="transient">Transient</h3>
<p>In <em>general</em>, a transient object is simply one which is created when needed; and thrown 
away when it&#39;s fulfilled its purpose.</p>
<p>This typically translates to calling the <code>new</code> operator with the constructor of a particular type, 
when you want an object, and then allowing that object to go out of scope, as in this snippet:</p>
<pre><code class="lang-cs">// Factory method always creates a new instance
static MyObject CreateObject()
{
    return new MyObject();
}

static MyObject _transient = CreateObject();

void Test()
{
    var transient1 = CreateObject();
    var transient2 = CreateObject();
    //note - using XUnit nomenclature here
    Assert.NotSame(transient1, transient2);
    Assert.NotSame(_transient, transient1);
    Assert.NotSame(_transient, transient2);
}
</code></pre><p>This idea of transience is encompassed by the following targets in the <a class="xref" href="../../api/Rezolver.Targets.html">Rezolver.Targets</a> namespace:</p>
<ul>
<li><a class="xref" href="../../api/Rezolver.Targets.ConstructorTarget.html">ConstructorTarget</a></li>
<li><a class="xref" href="../../api/Rezolver.Targets.DecoratorTarget.html">DecoratorTarget</a></li>
<li><a class="xref" href="../../api/Rezolver.Targets.DelegateTarget.html">DelegateTarget</a> <em>(see below)</em></li>
<li><a class="xref" href="../../api/Rezolver.Targets.ExpressionTarget.html">ExpressionTarget</a> <em>(see below)</em></li>
<li><a class="xref" href="../../api/Rezolver.Targets.GenericConstructorTarget.html">GenericConstructorTarget</a></li>
<li><a class="xref" href="../../api/Rezolver.Targets.ListTarget.html">ListTarget</a></li>
</ul>
<p>Remember that a target in Rezolver is an instruction to perform an <em>action</em> when the associated service
type is resolved by the container.  In the case of the above list, for all but two we can <em>definitely</em> say that 
a new object will be created if that target is registered against a type that&#39;s requested.</p>
<p>So, the <a class="xref" href="../../api/Rezolver.Targets.ConstructorTarget.html">ConstructorTarget</a> will always result in a type&#39;s constructor being called; the 
<a class="xref" href="../../api/Rezolver.Targets.ListTarget.html">ListTarget</a> will always result in a new <code>Array</code> or <code>List&lt;T&gt;</code> being created, and so on.</p>
<p>In the case of the <a class="xref" href="../../api/Rezolver.Targets.DelegateTarget.html">DelegateTarget</a> and <a class="xref" href="../../api/Rezolver.Targets.ExpressionTarget.html">ExpressionTarget</a> targets, however,
all we can say about those is that the <strong><em>action</em></strong> they represent will be executed <em>every time</em> the container 
resolves them.</p>
<p>That&#39;s the same as if we were to change the definition of <code>CreateObject</code> in our earlier code example as 
follows:</p>
<pre><code class="lang-cs">private static IMyObjectService _service = new MyObjectService();

static MyObject CreateObject()
{
    return _service.GetObject();
}
</code></pre><p>The point here being that we can no longer <strong>guarantee</strong> the transience of the object that is produced by the
<code>CreateObject</code> method because we no longer know how the service is producing that object.  All we can definitely 
say is that we <em>definitely</em> execute the service&#39;s <code>GetObject</code> method every time we call <code>CreateObject</code>.</p>
<p>We will go into more depth about using delegates and expressions (and indeed custom targets) as we delve deeper
into the Rezolver framework - but for now it&#39;s important to know that some targets produce inherently transient
results, whereas some <em>might</em> do, but they equally might <strong><em>not</em></strong>.</p>
<h3 id="singleton">Singleton</h3>
<p>Every developer should know what a singleton is.  Okay - any <em>reasonably experienced</em> developer should know what
a singleton is!</p>
<p>In short, a singleton is exactly as the name suggests: a type for which there is <strong>guaranteed</strong> to be only one 
instance.</p>
<p>Here&#39;s a simple implementation (note: please don&#39;t take this as the best, or <em>only</em>, way to implement one - it&#39;s
just an example!):</p>
<pre><code class="lang-cs">public class MySingleton
{
    public MySingleton Instance { get; } = new MySingleton();

    private MySingleton()
    {

    }
}
</code></pre><p>An application wishing to use the <code>MySingleton</code> object must do so through the <code>Instance</code> property, which is
the only instance of that type for the entire <code>AppDomain</code>.</p>
<p>Equally, if the singleton object implements an interface or base, then it can be passed to code which requires
an instance of that interface or base without knowing that the underlying object itself is always the same 
reference.</p>
<div class="NOTE"><h5>Note</h5><p>Different IOC containers have differing understandings of what a singleton really is.
In some cases it&#39;s one instance per-AppDomain (as with the above code snippet) and in other cases it&#39;s
one instance per-container.</p>
<p>In yet more cases, it&#39;s configurable or, indeed, extensible.</p>
<p>Rezolver currently supports one instance per-AppDomain, but in future it will also support one per-container 
as well as possibly an API through which you can extend the behaviour.</p>
</div>

            </article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/ZolutionSoftware/Rezolver/blob/dev/doc/Rezolver.Documentation/_docfx_proj/docs/basic-usage/object-lifetimes.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>Copyright &copy;2015 onwards <a href="http://www.zolution.co.uk" target="_blank">Zolution Software Ltd</a><br>Generated by <a href="https://dotnet.github.io/docfx/" target="_blank">DocFX</a>, with the Rezolver theme</span>
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
