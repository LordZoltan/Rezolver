<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
  	<meta charset="utf-8">
  	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  	<title>Creating and using a container | Rezolver IOC </title>
  	<meta name="viewport" content="width=device-width">
  	<meta name="title" content="Creating and using a container | Rezolver IOC ">
  	<meta name="generator" content="docfx 2.40.1.0">
  	<meta name="description" content="Rezolver is the portable open-source IOC container framework for .Net - built from the ground up for .Net Core, Asp.Net Core, and also optimised for the 'full .Net' :)">
  	<link rel="shortcut icon" href="../favicon.ico">
  	<link rel="stylesheet" href="../styles/docfx.vendor.css">
  	<link rel="stylesheet" href="../styles/docfx.css">
  	<link rel="stylesheet" href="../styles/main.css">
  	<meta property="docfx:navrel" content="../toc.html">
  	<meta property="docfx:tocrel" content="toc.html">
  	
  	<meta property="docfx:rel" content="../">
  	
  		<link rel="apple-touch-icon" sizes="57x57" href="../../apple-touch-icon-57x57.png">
  		<link rel="apple-touch-icon" sizes="60x60" href="../../apple-touch-icon-60x60.png">
  		<link rel="apple-touch-icon" sizes="72x72" href="../../apple-touch-icon-72x72.png">
  		<link rel="apple-touch-icon" sizes="76x76" href="../../apple-touch-icon-76x76.png">
  		<link rel="apple-touch-icon" sizes="114x114" href="../../apple-touch-icon-114x114.png">
  		<link rel="apple-touch-icon" sizes="120x120" href="../../apple-touch-icon-120x120.png">
  		<link rel="apple-touch-icon" sizes="144x144" href="../../apple-touch-icon-144x144.png">
  		<link rel="apple-touch-icon" sizes="152x152" href="../../apple-touch-icon-152x152.png">
  		<link rel="apple-touch-icon" sizes="180x180" href="../../apple-touch-icon-180x180.png">
  		<link rel="icon" type="image/png" href="../../favicon-32x32.png" sizes="32x32">
  		<link rel="icon" type="image/png" href="../../android-chrome-192x192.png" sizes="192x192">
  		<link rel="icon" type="image/png" href="../../favicon-96x96.png" sizes="96x96">
  		<link rel="icon" type="image/png" href="../../favicon-16x16.png" sizes="16x16">
  		<link rel="manifest" href="../../manifest.json">
  		<link rel="mask-icon" href="../../safari-pinned-tab.svg" color="#5bbad5">
  		<meta name="msapplication-TileColor" content="#da532c">
  		<meta name="msapplication-TileImage" content="../../mstile-144x144.png">
  		<meta name="theme-color" content="#ffffff">
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../../content/rz_square_white_on_orange_48x48.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
        		<p class="navbar-text navbar-right github-link"><a href="http://github.com/ZolutionSoftware/Rezolver" target="_blank" title="See this project on Github"><span class="fa fa-github"></span></a></p>
        		<form class="navbar-form navbar-right" role="search" id="search">
        		<div class="form-group">
        			<input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
        		</div>
        		</form>
        		<p class="navbar-text navbar-right">
        			<a href="https://www.nuget.org/packages/Rezolver" target="_blank"><img src="//img.shields.io/nuget/v/Rezolver.svg?style=plastic&amp;maxage=480" title="Get the Nuget Package"></a>
        			<a href="http://waffle.io/ZolutionSoftware/Rezolver" title="Open the Waffleboard for this project" target="_blank"><img alt="Work in Progress" src="https://badge.waffle.io/ZolutionSoftware/Rezolver.png?label=in%20progress&title=In%20Progress"></a>
        			<!-- <a href="http://waffle.io/ZolutionSoftware/Rezolver" title="Open the Waffleboard for this project" target="_blank"><img alt="Work prepared" src="https://badge.waffle.io/ZolutionSoftware/Rezolver.png?label=ready&title=Ready"></img></a> -->
        		</p>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="creating-and-using-a-container">Creating and using a container</h1>

<p>Using Rezolver is the same as with all other IOC containers:</p>
<ul>
<li>Create and configure the root container</li>
<li>Register the services which your application needs</li>
<li>Resolve services from the container</li>
</ul>
<p>All of this setup is ultimately conducted through just a few primary types, which we&#39;ll take a brief look at
now.</p>
<h1 id="core-types">Core types</h1>
<p>For all the built-in container types, Rezolver splits registration and resolving responsibilities between 
two interfaces:</p>
<h2 id="rezolveritargetcontainer"><a class="xref" href="../api/Rezolver.ITargetContainer.html">ITargetContainer</a></h2>
<div class="NOTE"><h5>Note</h5><p>You&#39;ll notice that the constructors for the <a class="xref" href="../api/Rezolver.Container.html">Container</a> and <a class="xref" href="../api/Rezolver.ScopedContainer.html">ScopedContainer</a> types (see next)
actually accept an instance of <a class="xref" href="../api/Rezolver.IRootTargetContainer.html">IRootTargetContainer</a>.  This is a new interface added in v1.3.2 which
marks a target container as a &#39;top-level&#39; one - and supports functionality such as 
<a href="variance/covariance.html">covariance</a>.  <code>IRootTargetContainer</code> also implies the <code>ITargetContainer</code> interface.</p>
</div>
<p>This interface describes a registry of <a class="xref" href="../api/Rezolver.ITarget.html">ITarget</a> objects, keyed by type, describing the type of object 
that is to be created (and how) when a given type is requested.</p>
<p>It is through this interface that you setup your container with registrations, which are then later used when 
resolving objects.</p>
<div class="TIP"><h5>Tip</h5><p>The primary implementation of this interface that you will use in your application is <a class="xref" href="../api/Rezolver.TargetContainer.html">TargetContainer</a> - 
either created implicitly by the framework or explicitly in your own code.</p>
</div>
<h2 id="rezolvericontainer"><a class="xref" href="../api/Rezolver.IContainer.html">IContainer</a></h2>
<p>This is the interface through which we resolve objects.  The interface does not expose any registration 
mechanisms at all (even if the classes providing the &#39;standard&#39; implementations all do) - only the ability
to request objects from the container.</p>
<p>This interface does not mandate that a container has an <code>IRootTargetContainer</code>, it&#39;s simply the case
that all the provided implementations which we will discuss in the rest of this documentation do
use that interface as the source of their service registrations.</p>
<div class="TIP"><h5>Tip</h5><p>The primary implementation of this interface is <a class="xref" href="../api/Rezolver.ContainerBase.html">ContainerBase</a>, an abstract class which also 
implements the <a class="xref" href="../api/Rezolver.ITargetContainer.html">ITargetContainer</a> interface by wrapping around the <a class="xref" href="../api/Rezolver.ContainerBase.html#Rezolver_ContainerBase_Targets">Targets</a> 
property that it exposes.</p>
<p>As a consumer of Rezolver, however, you will be using the <a class="xref" href="../api/Rezolver.Container.html">Container</a> and <a class="xref" href="../api/Rezolver.ScopedContainer.html">ScopedContainer</a> 
classes most of the time - which derive most of their functionality from this abstract class.</p>
</div>
<h1 id="creating-a-container">Creating a container</h1>
<p>There are numerous ways to create an <a class="xref" href="../api/Rezolver.IContainer.html">IContainer</a> instance.  The easiest, from the point of view of registering
services and then resolving them, is to create an instance of the <a class="xref" href="../api/Rezolver.Container.html">Container</a> type.  Or, if you want your root
container to act as a global lifetime scope for <a href="lifetimes/scoped.html">explicitly scoped objects</a> then you
can also use <a class="xref" href="../api/Rezolver.ScopedContainer.html">ScopedContainer</a>:</p>
<pre><code class="lang-cs">// create a standard non-scoping container
var container = new Container();

// or create a scoped container:
var container = new ScopedContainer();
</code></pre><p><em>All code samples assume you have added a <code>using</code> statement (<code>imports</code> in VB) for the <code>Rezolver</code> namespace.</em></p>
<p>Once you have a local reference to either of these classes, you can start registering services via the 
container&#39;s <a class="xref" href="../api/Rezolver.ITargetContainer.html">ITargetContainer</a> implementation, and resolving objects from it.</p>
<h2 id="registering-services">Registering services</h2>
<p>As mentioned above, with our default implementations of <a class="xref" href="../api/Rezolver.IContainer.html">IContainer</a>, registration of services ultimately 
means adding targets to the container&#39;s <a class="xref" href="../api/Rezolver.ContainerBase.html#Rezolver_ContainerBase_Targets">Targets</a> target container, associating them with service 
types which we will later resolve.  </p>
<p>The core registration method for this is the <a class="xref" href="../api/Rezolver.ITargetContainer.html#Rezolver_ITargetContainer_Register_">Register</a>
method, which accepts an <a class="xref" href="../api/Rezolver.ITarget.html">ITarget</a> and an optional type against which the registration is to be made.</p>
<p>Here&#39;s an example where we register the type <code>Foo</code> to be created whenever an instance of <code>IFoo</code> is requested,
directly via a container&#39;s own implementation of <a class="xref" href="../api/Rezolver.ITargetContainer.html">ITargetContainer</a>:</p>
<pre><code class="lang-cs">var container = new Container();
container.RegisterType&lt;Foo, IFoo&gt;();
</code></pre><p>Or, if you create a dedicated <a class="xref" href="../api/Rezolver.ITargetContainer.html">ITargetContainer</a> that you specifically want the <a class="xref" href="../api/Rezolver.Container.html">Container</a> to
use, only a small change is required:</p>
<pre><code class="lang-cs">var targets = new TargetContainer();
targets.RegisterType&lt;Foo, IFoo&gt;();

var container = new Container(targets);
</code></pre><div class="TIP"><h5>Tip</h5><p>The <a class="xref" href="../api/Rezolver.RegisterTypeTargetContainerExtensions.html#Rezolver_RegisterTypeTargetContainerExtensions_RegisterType_">RegisterType</a> overload instructs the container to build
an instance via <a href="constructor-injection/index.html">constructor injection</a>.</p>
</div>
<p>There&#39;s too many types of registrations to cover in a few sub headings here for this - 
<a href="service-registration.html">the service registration topic</a> has more detail, with links to all the other 
different types of registration you can perform.</p>
<p>Moreover, you can browse the different topics from the table of contents on the left (or top on mobile).</p>
<h2 id="resolving-services">Resolving services</h2>
<p>Resolving objects from your container is done through the <a class="xref" href="../api/Rezolver.IContainer.html#Rezolver_IContainer_Resolve_">Resolve</a> method which, you&#39;ll
notice, accepts an <a class="xref" href="../api/Rezolver.IResolveContext.html">IResolveContext</a> as its single parameter, and returns an <code>Object</code>.  Again, if 
you&#39;re familiar with IOC containers then you&#39;re probably wondering where your strongly-typed <code>Resolve&lt;TService&gt;()</code> 
method is!</p>
<p>Well, fear not.  As with the many extension methods available on <a class="xref" href="../api/Rezolver.ITargetContainer.html">ITargetContainer</a>, the <a class="xref" href="../api/Rezolver.IContainer.html">IContainer</a>
interface (through which all resolving of objects is done) has extension methods to provide a more traditional
IOC API, and these are found on the <a class="xref" href="../api/Rezolver.ContainerResolveExtensions.html">ContainerResolveExtensions</a> static class.</p>
<p>The one you&#39;ll use most frequently, of course, is the <a class="xref" href="../api/Rezolver.ContainerResolveExtensions.html#Rezolver_ContainerResolveExtensions_Resolve__1_Rezolver_IContainer_">Resolve&lt;TObject&gt;(IContainer)</a>
method, which provides the aforementioned <code>Resolve&lt;TService&gt;()</code> API.</p>
<p>So, assuming we have the <code>container</code> that we&#39;ve been using up till now, we would resolve an instance of <code>MyService</code>
simply by doing one of the following:</p>
<pre><code class="lang-cs">MyService service = container.Resolve&lt;MyService&gt;();
//or
MyServiceBase service = container.Resolve&lt;MyServiceBase&gt;();
//or
IMyService service = container.Resolve&lt;IMyService&gt;();
</code></pre><div class="NOTE"><h5>Note</h5><p>The <a class="xref" href="../api/Rezolver.IResolveContext.html">IResolveContext</a> interface captures the context of a call to the <code>Resolve</code> method, tracking the
container on which the call is originally made, whether there is an <a class="xref" href="../api/Rezolver.IContainerScope.html">IContainerScope</a> active for the call,
and other things besides.  You will rarely use it directly in application code unless you are extending Rezolver.</p>
<p>These <code>Resolve</code> extension methods create the <code>IResolveContext</code> for a given operation on your behalf, so you never
have to worry about it.</p>
</div>
<p>Assuming the container can locate the service registration for the type you request, it will fetch/produce an
instance of the associated object type according to the behaviour described by the <a class="xref" href="../api/Rezolver.ITarget.html">ITarget</a> which we 
previously registered.</p>
<p>If no registration is found, then an <code>InvalidOperationException</code> is raised by the container.</p>
<div class="TIP"><h5>Tip</h5><p><a class="xref" href="../api/Rezolver.IContainer.html">IContainer</a> also implements the <code>System.IServiceProvider</code> interface from the .Net framework, which requires
that missing services yield a <code>null</code> result instead of throwing an exception.</p>
</div>
<h3 id="canresolvetryresolve">CanResolve/TryResolve</h3>
<p>Sometimes you might want to <em>attempt</em> to resolve an object from the container, but not have an exception raised
if it cannot be found.  In this case you can use the <a class="xref" href="../api/Rezolver.IContainer.html#Rezolver_IContainer_TryResolve_">TryResolve</a> method, which returns the
object via an <code>out</code> parameter and returns a <code>bool</code> indicating whether the operation succeeds.</p>
<p>Naturally, as with the <code>Resolve</code> operation, this method has a generic overload
(<a class="xref" href="../api/Rezolver.ContainerResolveExtensions.html#Rezolver_ContainerResolveExtensions_TryResolve__1_Rezolver_IContainer___0__">TryResolve&lt;TObject&gt;(IContainer, out TObject)</a>) to avoid the need for a 
temporary <code>Object</code> reference:</p>
<pre><code class="lang-cs">MyService result;
bool success = container.TryResolve(out result);
//success == true or false depending on registrations.
</code></pre><p>Similarly we can also introspect a container to find out if it <em>can</em> resolve an instance of a given type
by using the <a class="xref" href="../api/Rezolver.IContainer.html#Rezolver_IContainer_CanResolve_">CanResolve</a> method.  This method also has friendly overloads via extension
methods (e.g. <a class="xref" href="../api/Rezolver.ContainerResolveExtensions.html#Rezolver_ContainerResolveExtensions_CanResolve__1_Rezolver_IContainer_">CanResolve&lt;TObject&gt;(IContainer)</a>)):</p>
<pre><code class="lang-cs">bool canResolve = container.CanResolve&lt;MyService&gt;();
</code></pre><hr>
<h1 id="container-configurations-and-options">Container Configurations and Options</h1>
<p>For those looking to customise or extend Rezolver, many of the types are overridable.  However, 
the <a class="xref" href="../api/Rezolver.ITargetContainer.html">ITargetContainer</a> and <a class="xref" href="../api/Rezolver.IContainer.html">IContainer</a> implementations mentioned above also use
another mechanism that provides extensibility without having to subclass them.</p>
<div class="NOTE"><h5>Note</h5><p>This is an advanced topic and not one that you should have to worry about most of the time.  The examples in
this guide will highlight where you can use the functionality described below - this section is intended to be 
a high-level overview only. </p>
</div>
<p>There are two primary types of container configuration in Rezolver:</p>
<ol>
<li><strong>Target container configuration</strong> (via implementations of <a class="xref" href="../api/Rezolver.ITargetContainerConfig.html">ITargetContainerConfig</a>)</li>
<li><strong>Container configuration</strong> (via implementations of <a class="xref" href="../api/Rezolver.IContainerConfig.html">IContainerConfig</a>)</li>
</ol>
<p>Both are very similar in that they define a method called <code>Configure</code> (see 
<a class="xref" href="../api/Rezolver.ITargetContainerConfig.html#Rezolver_ITargetContainerConfig_Configure_">ITargetContainerConfig.Configure</a> and 
<a class="xref" href="../api/Rezolver.IContainerConfig.html#Rezolver_IContainerConfig_Configure_">IContainerConfig.Configure</a>) to 
which is passed an <a class="xref" href="../api/Rezolver.ITargetContainer.html">ITargetContainer</a> and, in the case of <a class="xref" href="../api/Rezolver.IContainerConfig.html">IContainerConfig</a>, also an
<a class="xref" href="../api/Rezolver.IContainer.html">IContainer</a>.</p>
<p>Implementations of the interfaces can add/modify service registrations which are then used either directly by the 
container, or which provide more advanced registration functionality.</p>
<p>For example, Rezolver&#39;s <a href="enumerables.html">automatic enumerable injection</a> is enabled by the 
<a class="xref" href="../api/Rezolver.Configuration.InjectEnumerables.html">InjectEnumerables</a> configuration when it configures an <a class="xref" href="../api/Rezolver.ITargetContainer.html">ITargetContainer</a>.  This configuration
is actually applied to all instances of <a class="xref" href="../api/Rezolver.TargetContainer.html">TargetContainer</a> by default (via the <a class="xref" href="../api/Rezolver.TargetContainer.html#Rezolver_TargetContainer_DefaultConfig">DefaultConfig</a>
configuration collection) - but you can also control whether enumerable injection is enabled without having to remove the 
configuration from that collection, <a href="enumerables.html#disabling-enumerable-injection">as is shown in the last enumerable example</a>.</p>
<p>There is much more to be covered about configuration and options.  For now - use them where this guide shows you can
(e.g. to <a href="variance/contravariance.html#disabling-contravariance-advanced">control contravariance</a> or 
<a href="member-injection/index.html">member binding behaviour</a> etc), and if you want to be able to control
something else this way, and can&#39;t, then just open an issue on Github.</p>
<hr>
<h1 id="next-steps">Next Steps</h1>
<ul>
<li>Read up on how to <a href="service-registration.html">register services in the container</a>.</li>
<li>Alternatively, if you haven&#39;t already, take a look Rezolver&#39;s understanding of <a href="lifetimes/index.html">object lifetimes</a>.</li>
</ul>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/ZolutionSoftware/Rezolver/blob/autofactories/doc/Rezolver.Documentation/_docfx_proj/docs/create-and-use-a-container.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>Copyright &copy;2014 onwards <a href="http://www.zolution.co.uk" target="_blank">Zolution Software Ltd</a><br>Generated by <a href="https://dotnet.github.io/docfx/" target="_blank">DocFX</a>, with the Rezolver theme</span>
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
